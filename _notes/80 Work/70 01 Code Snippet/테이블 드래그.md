
# 테이블 순서 변경
1. 스크립트와 관련 css 를 적용한다.
```Javascript
<script src="https://cdnjs.cloudflare.com/ajax/libs/TableDnD/0.9.1/jquery.tablednd.js" integrity="sha256-d3rtug+Hg1GZPB7Y/yTcRixO/wlI78+2m08tosoRn7A=" crossorigin="anonymous"></script> <link rel="stylesheet" href="/css/products.css" th:attrappend="href='?ver='+${@environment.getProperty('cache.version')}" />
```


2. drag & no-drag를 해야할 곳에 분기문을 두어 클래스를 다르게 하고 id를 부여할 수 있게 추가한다.
```vue
v-bind:class="data.isDeactivated == 'n' ? 'drag' :'nodrag nodrop'" v-bind:id="'row_'+ data.adMediaId"
```


3. drag가 가능하게 해당 클래스를 설정하고 `<td>`내에 정렬한 데이터를 기준으로 유니크한 값을 가져올 수 있게 input 필드를 추가한다.

```javascript
<td class="text-center dragHandle"> {{data.displaySeq}} <i class='fa fa-bars d-none'></i></td> <input type="hidden" name="adMediaIds" v-if="data.isDeactivated == 'n'" v-bind:value="data.adMediaId">
```

4. dom이 재 렌더링 후 작동하게 update 라이프사이클에 tablednd를 추가한다.

```JavaScript
updated: function() { 
	$('#list').tableDnD({ 
		onDragClass: 'alt', 
		dragHandle: '.dragHandle', 
		onDrop: function (table,row) {},
		onDragStart: function (table,row) {}, 
	}); 
	$('#listtr.drag').addClass('nodrag').addClass('nodrop'); 
	let isEdit = true; 
	$('#btnSort').click(function () { 
		if (isEdit) { 
			$(this).html('저장'); 
			$('#listtr.drag').removeClass('nodrag').removeClass('nodrop'); 
			$('#list td.dragHandlei').removeClass('d-none'); isEdit = false; 
		} else { 
			let adMediaIdLength = $("input[name=adMediaIds]").length; 
			let data = []; 
			for (let i = 0; i < adMediaIdLength; i++) { 
				let item = {}; 
				item.adMedia_id = $("input[name=adMediaIds]").eq(i).val(); 
				item.display_seq = i + 1; item = JSON.stringify(item); 
				data.push(JSON.parse(item)); 
			} 
			$.ajax({ 
				type: 'POST', 
				url: '/ddksrecommendbook/api/sort', 
				data: JSON.stringify(data), 
				dataType: 'json', 
				processData: true, 
				contentType: 'application/json; charset=UTF-8', 
				cache: false, 
				imeout: 600000, 
				success: function () { 
					$('#btnSort').prop('disabled', false); 
					location.reload(); 
				}, 
				error: function (e) { 
					$('#btnSort').prop('disabled', false); 
					if (e&&e.responseText) { 
						alert(e.responseText); 
					} else if (e.responseText === '') { 
						location.reload();
					} 
				}, 
			}); 
		} 
	}); 
}
```