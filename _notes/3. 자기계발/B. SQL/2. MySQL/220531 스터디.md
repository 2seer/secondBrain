2022-05-26 18:11
## Study Note
---
aliases : [INDEX, ]

tags : #MySQL

---

## 내용
### 선택도(기수성)
인덱스에서 선택도와 기수성은 거의 같은 의미로 사용된다(다른 점이 있다면??)
공통적인 점은 모든 인덱스 키 값 가운데 유니크한 값의 수를 의미한다.  

인덱스 키 값이 100개 중 유니크한 값의 수가 10개면 기수성은 10이다.
인덱스 키 값 가운데 중복된 값이 많아질 수록 기수성이 낮아지고 동시에 선택도 또한 떨어진다.
인덱스는 선택도가 높을 수록 검색대상이 줄어들기 때문에 그만큼 빠르게 처리된다..

다만 선택도가 좋지 않다하더라도 정렬이나 그루핑 같은 작업을 위해 인덱스를 만드는게 훨씬 나은 경우가 많다고 한다. 인덱스가 항상 검색에는 쓰이는 게 아니므로 상황에 따라 설계할 필요가 있다.

전체 레코드 수 : 10,000

유니크한 값의 갯수
케이스 A : country 컬럼의 유니크한 값의 개수가 10 (기수성 : 10,000/10 = 1,000)
케이스 B : country 컬럼의 유니크한 값의 개수가 1000 (기수성 : 10,000/1,000 = 10)


```mysql
CREATE TABLE tb_city(
	country VARCHAR(10),
	city VARCHAR(10),
	INDEX ix_country (country)
);
SELECT * FROM tb_city WHERE country = 'KOREA' AND city = 'SEOUL'; 
```

MySQL 에서는 인덱스의 통계 정보(유니크한 값의 개수)가 관리되기 때문에 city 컬럼의 기수성은 작업 범위에 아무런 영향을 미치지 못한다.
위의 쿼리를 실행시 케이스 A의 경우 평균 1,000건, 케이스 B의 경우 평균 10권이 조회될 수 있다는 것이 예측되는데 실제 조건을 만족하는 레코드가 단 1건만 있다면 케이스 A의 경우 999번 낭비가, B의 경우 9건만 낭비가 되어 A케이스가 적합하지 않는 것으로 볼 수 있다. (낭비인 케이스는 무엇)

### 읽어야 하는 레코드의 건수
 아무래도 인덱스를 통해 테이블의 레코드를 읽는 것은 인덱스를 거치지 않고 바로 테이블의 레코드를 읽는 것보다 높은 비용이 드는 작업이므로 상황에 따라서는 인덱스를 통해 필요한 레코드만 가져오는게 효율적인지 아니면 모두 읽고 필요 없는 건을 버리는게 효율적인지 판단을 해야한다.

 일반적으로 DBMS의 옵티마이저에서는 인덱스를 통해 레코드 1건을 읽는게 테이블에서 직접 레코드 1건을 읽는 것보다 4 ~ 5배 정도 비용이 더 많이 드는 작업으로 예측한다. 
 
 즉 인덱스를 통해 읽어야할 레코드의 건수가 전체 레코드의 20~25%를 넘어서면 인덱스를 사용하지 않는게 오히려 더 효율적이다.

 만약 전체 100만건 중 레코드 가운데 50만건을 읽어야 하는 작업의 경우 인덱스의 손익 분기점보다 훨씬 크기 때문에 옵티마이저가 인덱스를 사용하지 않고 작업을 수행한다고 한다(그리고 힌트를 추가해도 성능상 얻을 수 있는 이점은 없다)

![img](/assets/giphy.gif)

### B-Tree 인덱스를 통한 데이터 읽기
MySQL이 어떻게 인덱스를 이용해서 실제 레코드를 읽어내는지 대표벅인 방법 세 가지를 소개한다.
#### 인덱스 레인지 스캔
인덱스를 통해 레코드를 한 건만 읽는 경우(???), 인덱스를 통해 한 건 이상을 읽는 경우(???)를 모두 묶어서 인덱스 레이지 스캔이라고 표현한다.
```mysql
SELECT * FROM employees WHERE first_name BETWEEN 'Ebbe' AND 'Gad'
```


## ⏱Log
	- gif 테스트
## 의견
	-


📙출처 :
URL :